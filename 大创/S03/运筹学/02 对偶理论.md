1. [x] 线性规划的对偶理论 3.4
重点：表格 3-1，表 3-4 的应用、例 3-4，例 3-5，习题 3.7（关于矩阵描述的）

# 单纯形法的矩阵描述
![[Pasted image 20250107214205.png|600]]

# 如何转化对偶问题
表 3-4：![[Pasted image 20250107100744.png|500]]
每一个线性规划问题都有一个对应的对偶问题。

$$
\begin{align}
\max z=CX \\
st.AX+Xs=b \\
X,X_{S}\geq & 0
\end{align}
$$
对偶问题为
$$
\begin{align}
\min \omega=Yb \\
st.YA-Y_{S}=C \\
Y,Y_{S}\geq 0
\end{align}
$$

## 一个重要的 Insight

对偶问题的**最优解** 等于原问题松弛变量的**检验数**的相反数
其实这里还可以结合影子价格谈谈，以后再说。

| 原问题  | $X_{B}$      | $X_{N}$            | $X_{s}$        |
| ---- | ------------ | ------------------ | -------------- |
| 检验数  | 0            | $C_{N}-C_BB^{-1}N$ | $-C_{B}B^{-1}$ |
| 对偶问题 |  $Y_{S_{1}}$ | $-Y_{S_{2}}$       | $-Y$           |
原问题单纯形表的检验数行是其对偶问题的一个基解。

$Y_{S_{1}}$ 是对应原问题中 $X_{B}$ 的剩余变量，$Y_{S_{2}}$ 对应原问题中 $X_{N}$ 的剩余变量，$Y$ 是对偶变量。

# 对偶问题性质
## 01对称性
对偶问题的对偶是原问题

可由对称变换关系立证
## 02弱对偶性
若 $\bar{X}$ 是原问题的可行解，$\bar{Y}$ 是对偶问题的可行解，那么
$$
C \bar{X}\leq \bar{Y}b
$$
Proof Structure: 以 $\bar{Y}A \bar{X}$ 为桥梁，链接不等式两端
## 03无界性
若原问题（对偶问题）为无界解，则其对偶问题（原问题）无可行解

由弱对偶性立得到。（不可能 $\max z\leq-\infty$，也不可能 $\min \omega\geq+\infty$）

命题不可逆。

**可以快速检验某些问题是否有可行解**

### 例题
已知线性规划问题
$$
\begin{align}
\max z&=x_{1}+x_{2} \\
&\begin{cases}
-x_{1}+x_{2}+x_{3}\leq 2 \\
-2x_{1}+x_{2}-x_{3}\leq 1 \\
x_{1},x_{2},x_{3}\geq 0
\end{cases}
\end{align}
$$
试证明上述线性规划问题无最优解

*Solution：*
首先注意到，这个问题有可行解，比如 $X=(0,0)$
写出对偶问题
$$
\begin{align}
\min \omega&=2y_{1}+y_{2} \\
&\begin{cases}
-y_{1}-2y_{2}\geq 1 \tag{1}\\
y_{1}+y_{2}\geq 1 \\
y_{1}-y_{2}\geq 0 \\
y_{1},y_{2}\geq 0
\end{cases}
\end{align}
$$
容易知道，第一个约束条件 (1) 永远不满足，即对偶问题 **无可行解**
这对应着：永远无法使得原问题的检验数达到最优状况，而原问题又有可行解，说明原问题无最优解。

## 04可行解是最优解时的性质
设 $\hat{X}$ 是原问题的可行解，$\hat{Y}$ 是对偶问题的可行解，那么当 $C \hat{X}=\hat{Y}b$ 时候，二者都来到最优解。

## 05对偶定理
若原问题有最优解，那么对偶问题也有最优解; 且目标函数值相同。

*Proof structure:*
若 $\hat{X}$ 是原问题最优解，那么非基变量的检验数都小于 0，即
$$
C-C_{B}B^{-1}A\leq 0
$$
$\hat{Y}A\geq C$，令 $\hat{Y}=C_{B}B^{-1}$
注意到 $\hat{Y}$ 是对偶问题的可行解，且有 $\hat{Y}b=C \hat{X}=C_{B}B^{-1}b$（因为 $z=C\hat{X}$，且此时 $X_{B}=(B^{-1}AX)_{B}=B^{-1}b$
由定理 04 得证。

## 06 互补松弛性

若 $\hat{X}$ 和 $\hat{Y}$ 分别是原问题和对偶问题的可行解：
$$
\hat{Y}X_{S}=0,Y_{S}\hat{X}=0\iff \hat{X},\,\hat{Y}是最优解
$$
*Proof structure:*
将原问题的 $C$ 用 $YA-Y_{S}$ 代替，对偶问题中的 $b$ 用 $AX+AX_{S}$ 代替，结合性质 4 。

*用处:*
可以快速从对偶问题的最优解，推导出原问题的最优解。

### 例题
> [!example] 例题 (3-5)
> 已知线性规划问题
$$
\begin{align}
\min \omega=2x_{1}+3x_{2}+5x_{3}+2x_{4}+3x_{5} \\
x_{1}+x_{2}+2x_{3}+x_{4}+3x_{5}\geq4 \\
2x_{1}-x_{2}+3x_{3}+x_{4}+x_{5}\geq 3 \\
x_{j}\geq 0,j=1,2,3,4,5
\end{align}
$$
已知对偶问题的最优解 $y_{1}^*=\frac{4}{5},y_{2}^*=\frac{3}{5},z=5$ ，用对偶理论求原问题最优解

解：写出对偶问题
$$
\begin{align}
\max z=4&y_{1}+3y_{2} \\
st.
&y_{1}+2y_{2}\leq 2 \tag{1}\\
&y_{1}-y_{2}\leq 3 \tag2 \\
&2y_{1}+3y_{2} \leq 5\tag{3} \\
&y_{1}+y_{2}\leq 2 \tag{4}\\
&3y_{1}+y_{2}\leq 3 \tag{5}\\
&y_{1},y_{2}\geq 0
\end{align}
$$
代入最优解，得到 (2),  (3),  (4) 为**严格**的不等式（即松弛变量>0，约束条件未取等）
即 $\hat{X}Y_{S}$ 中的 $Y_{S}$ 中的第 2, 3, 4 列大于 0 
由互补松弛性，为满足 $\hat{X}Y_{S}=0$，则 $Y_{S}$ 中不为 0 的行， $\hat{X}$ 的对应列需要等于 0。
可得：$x_{2}^*=x_{3}^{*}=x_{4}^{*}=0$

又因为 $y_{1},y_{2}\geq 0$，即 $\hat{Y}>0$，则知道 $X_{S}=0$，反映在约束条件上就是原问题的两个约束条件都是取等号 $=$
结合起来，有
$$
\begin{cases}
x_{1}+3x_{5}=4 \\
2x_{1}+x_{5}=3
\end{cases}
$$
解得 $x_{1}^{*}=1,x_{5}^{*}=1$ ，原问题最优解为
$$
X^{*}=(1,0,0,0,1)^{T},\omega^{*}=z^{*}=5
$$