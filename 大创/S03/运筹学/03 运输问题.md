---
本科课程: 运筹优化
---
# 复习规划
- [x] Chapter 4 运输问题
1. [x] 运输问题的数学模型第 4.1 节
2. [x] *表上作业法*第 4.2、 4.3 节（产销不平衡问题）

# 数学模型

已知有 $m$ 个生产地点 $A_{i}$，$i=1,2,\cdots,m$ 可供应某种物资，其供应量（产量）分别为 $a_{i}$，$i=1,2,\dots,m$
有 $n$ 个销地 $B_{j}$，$j=1,2,3,\dots,n$，其需要量分别为 $b_{j}$，$j=1,2,3,\dots ,n$
从 $A_{i}$ 销往 $B_{j}$ 的运输单位物资的运价（单价）为 $c_{ij}$

我们要最节约成本，即让总运费最小，即求下面的线性规划问题
$$
\begin{align}
\min z&=\sum_{i=1}^{m}\sum _{j=1}^{n}c_{ij}x_{ij} \\
st. \\
&\sum_{i=1}^{m}x_{ij}=b_{j}, \;j=1,2,\dots,n \\
&\sum_{j=1}^{n}x_{ij}=a_{i}, \;i=1,2,\dots,m \\
&x_{ij}\geq  0
\end{align}
$$
共 $m\times n$ 个变量，$m+n$ 个约束方程.
由于 $\sum_{i=1}^{m}a_{i}=\sum_{j=1}^{n}b_{j}$，故该线性规划的 $m+n$ 个约束条件构成的在系数矩阵中的 $m+n$ 个非零行，存在可以互相表示的情况，故该系数矩阵的**秩**满足
$$
r(A)\leq m+n-1
$$
运输问题作为线性规划有很多良好的独特性质，所以我们可以用单纯形法之外的更方便的方法来求解。
# 表上作业法
## 在什么样的表上作业？
![[Pasted image 20250107133732.png|600]]
利用 **单位运价表** 和 **产销平衡表**
具体步骤和单纯形法类似：

1. 找初始可行解：在产销平衡表上，给出 m+n-1 个数字作为初始运输方案
2. 求非基变量的检验数（位势法），决定给出最优解或继续迭代
3. 确定换入和换出变量，找到新的基可行解，用闭回路法调整（本质是资源调配的“有借必有贷”，保证总体平衡 ）
4. 重复 2,3 直到最优解产生。

## 如何给出初始解？
### 最小元素法
#### 基本思想：就近供应
贪心算法。
优先供应最小的运价 $c_{ij}=\min\left\{ C \right\}$，使得 $A_{i}$ 到 $B_{j}$ 满足 $A$ 全部倾销完毕，或 $B$ 需求全部满足
不再考虑全部满足了的产地或销地，在表上体现为划去所在行或列。继续执行贪心算法。直到给出最终解。

### 伏格尔法
#### 基本思想：多看一步
贪心算法。区别是按照**运费最小和次小差额最大**来作为局部最优标准。思想是考虑到了 **机会成本**，即如果我不优先供货最小运费调用，我接下来要花多少的代价（运费增加越多）。所以差额越大，应当采用最小运费调用。

步骤：
1. 计算各行各列最小和次小差额，选择**差额最大的**所在行或列的最小元素。对供应完的不再考虑，在表上体现为划去所在行或列。
2. 对剩余元素继续执行，直到给出初始解。

伏格尔法给出的第一次迭代的结果有时候称作近似最优解.

## 如何判别最优解

在产销平衡表计算表基础上，进行作业计算检验数 $\sigma_{ij}$
主要有两种方法。
### 闭回路法
从每一个空格（空格对应非基变量，检验数有优化意义）出发找一条闭回路。
水平竖直线划，遇见数字格转 90°，直到回到初始空格。
经济解释：为了保持产销平衡，在基变量内部的平衡性的变换（此增，下一个转弯出就要减，反之同理，以此保证产销平衡）。
表达着如果增加**单位** 空格所在调运方案的物资，会造成运价的变化，这在数值上，等于检验数。

实际操作在产销平衡表**右上角**标注单位运价，计算每一个空格子。![[Pasted image 20250107134958.png|600]]

### 位势法

每个决策变量 $x_{ij}$，其在系数矩阵 $A$ 中对应的系数向量 $P_{ij}$ 可以看作两个约束条件分别决定的一个分块的向量, $P_{ij}=e_{i}+e_{m+j}$
即 
$$
P_{ij}=(0,0,\dots,1_{第i位},0,\dots ,1_{第m+j位},0,0)^T
$$


回忆[[02 对偶理论#一个重要的 Insight|对偶理论]]，知道**检验数行**实质上构成了对偶问题的**可行解**，有
$$
C_{B}B^{-1}=(u_{1},u_{2},\cdots,u_{m};\;v_{1},v_{2},\cdots,v_{n})
$$

故检验数 $\sigma_{ij}$
$$
\sigma_{ij}=c_{ij}-C_{B}B^{-1}P_{ij}=c_{ij}-(u_{i}+v_{j})
$$
那么我们就可以通过 $m+n-1$ 个基变量的检验数为 0，列出 $m+n-1$ 个方程，而我们的未知数 $u_{1},u_{2},\dots,u_{m};\;v_{1},v_{2},\dots,v_{n}$ 有 $m+n$ 个，这个未定方程组我们只需令 $u_{1}=0$ (或其他赋值) 就可求得。

这样我们就计算出了所有检验数需要的数据。再用 $c_{ij}$ 作差即可

在表上作业的时候，一般增加一行一列，作为 $u_i$ 和 $v_{j}$，然后确定行位势和列位势 (即 $u_{i},v_{j}$)
设计如下的计算表，仍然在右上角标注单位运价，检验数填在空格中。

同样的，如果非基变量的检验数为 0，该问题有无穷多最优解。

![[Pasted image 20250107140711.png|600]]

## 调整优化——闭回路法
### 优化谁？(换入变量)
若在判别最优解过程中出现负检验数，说明未得到最优解。一般选其中最小的检验数，以它所在的空格作为**调入格**。（作为换入变量）
### 调入多少？（换出变量）
以此格为出发点，构建一个连接基变量的闭回路。从调入格子出发，依次标记 $+1,-1,+1,-1,\dots$ （+1 表示调入，-1 表示调出）

确定调入：调入量 $\theta$ 选择闭回路上具有 $-1$ 标记中的最小者，即 $\theta=\min(需要调出格的最少运量)$，这和单纯形法中的 $\theta$ 最小规划是一致的，都是为了保证约束条件（在这里具体表现为产销平衡）能够满足。$\theta$ 所对应的格子 $x_{kl}$ 将被全部调入，即值 $x_{kl}=0$，即作为换出变量。

然后按闭回路上的符号，依次加上、减去此值，即完成了一次优化迭代。


# 产销不平衡的处理

## 产大于销
之前的表上作业法建立在产销平衡上，即
$$
\sum_{i=1}^{m}a_{i}=\sum_{j=1}^{n}b_{j}
$$
当产大于销：
$$
\sum_{i=1}^{m}a_{i}>\sum_{j=1}^{n}b_{j}
$$
我们补充一个虚拟销地 $j=n+1$，其运费为 0. 在真实生产生活中表现为就地存储。
其需要量为
$$
\sum_{i=1}^{m}a_{i}-\sum_{j=1}^{n}b_{j}
$$
单位运价表更新：$c_{i,n+1}'=0$

类似的，销大于产时候，补充一个假想产地 $i=m+1$，产量为
$$
\sum_{j=1}^{n}b_{j}-\sum_{i=1}^{m}a_{i}
$$
这在生产中表现为销售的缺口。


